# Exercício 1

!!! success "**1.** Análise de Sequências de DNA"

Como explorou no [Lab 28/02](../lab02/intro.md), as sequências de DNA analisadas são comummente representadas por quatro nucleótidos: `A`, `C`, `T`, `G`. 

Nucleótidos desconhecidos aparecem frequentemente representados pelo caractere `N`, indicando uma posição onde o processo de sequenciação não conseguiu identificar  com confiança o respetivo nucleótido.

Considere agora os ficheiros `.fastq` (pasta `MiSeq`) da aula anterior:

- Procure todas as ocorrências que contenham segmentos de 10 nucleótidos desconhecidos consecutivos (e.g., `NNNNNNNNNN`).

??? question "*Resultado Esperado*"
    ```bash
    F3D0_S188_L001_R2_001.fastq:CCTGTTTGCTCCCCACGCTTTCGAGCCTCAACGTCAGTTACAGTCCAGCAAGCCGCCTTCGCCACTGGTGTTCCTCCTAATATCTACNCNTNNNNNNNNNNCACTAGGAATTCCACTTGCCTCTCCTGCACTCCAGCAGCACAGTTTCCAAAGCAGTCCGGGGGTTGGGCCCCCGCCTTTCACTTCAGACTTGCACTGCCGTCTACGCTCCCTTTACACCCAGTAAATCCGGATAACGCTTGCCCCCTACG
    (...) 
    ```

- Para além das sequências, escreva um comando que inclua também o identificador da sequência e as linhas do ficheiro onde o padrão ocorre. Escreva o resultado para um ficheiro `bad_sequences.txt`.
- Use o comando `wc` para contar o número de linhas do ficheiro `bad_sequences.txt`. O número de linhas corresponde ao número de sequências encontrado? Porquê? 
- Escreva um comando `grep` que consiga filtrar o artefacto `--`. Investigue o argumento `-v` e procure um padrão regex adequado (use `^` para indicar o início de uma linha...)
- Use um commando `grep` para escrever apenas os ficheiros `.fastq` que contêm o padrão `NNNNNNNNNN` para um ficheiro `bad_files.txt`. Em quantos ficheiros encontramos este padrão?

??? question "*Resultado Esperado*"
    ```bash
    26 files
    ```
- No laboratório anterior, procurou sequências de nucleótidos do tipo `ATG......` no ficheiro `phix.fa`. Considere agora o ficheiro `HMP_MOCK.v35.fasta`. Que sequências terminam exactamente em `GACC`?

??? question "*Resultado Esperado*"
    ```bash
    >E.faecalis.1
    TAGGGAATCTTCGGCAATGGACGAAAGTCTGACCGAGCAACGCCGCGTGAGTGAAGAAGGTTTTCGGATCGTAAAACTCTGTTGTTAGAGAAGAACAAGGACGTTAGTAACTGAACGTCCCCTGACGGTATCTAACCAGAAAGCCACGGCTAACTACGTGCCAGCAGCCGCGGTAATACGTAGGTGGCAAGCGTTGTCCGGATTTATTGGGCGTAAAGCGAGCGCAGGCGGTTTCTTAAGTCTGATGTGAAAGCCCCCGGCTCAACCGGGGAGGGTCATTGGAAACTGGGAGACTTGAGTGCAGAAGAGGAGAGTGGAATTCCATGTGTAGCGGTGAAATGCGTAGATATATGGAGGAACACCAGTGGCGAAGGCGGCTCTCTGGTCTGTAACTGACGCTGAGGCTCGAAAGCGTGGGGAGCAAACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGAGTGCTAAGTGTTGGAGGGTTTCCGCCCTTCAGTGCTGCAGCAAACGCATTAAGCACTCCGCCTGGGGAGTACGACC
    >E.faecalis.2
    TAGGGAATCTTCGGCAATGGACGAAAGTCTGACCGAGCAACGCCGCGTGAGTGAAGAAGGTTTTCGGATCGTAAAACTCTGTTGTTAGAGAAGAACAAGGACGTTAGTAACTGAACGTCCCCTGACGGTATCTAACCAGAAAGCCACGGCTAACTACGTGCCAGCAGCCGCGGTAATACGTAGGTGGCAAGCGTTGTCCGGATTTATTGGGCGTAAAGCGAGCGCAGGCGGTTTCTTAAGTCTGATGTGAAAGCCCCCGGCTCAACCGGGGAGGGTCATTGGAAACTGGGAGACTTGAGTGCAGAAGAGGAGAGTGGAATTCCATGTGTAGCGGTGAAATGCGTAGATATATGGAGGAACACCAGTGGCGAAGGCGGCTCTCTGGTCTGTAACTGACGCTGAGGCTCGAAAGCGTGGGGAGCAAACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGAGTGCTAAGTGTTGGAGGGTTTCCGCCCTTCAGTGCTGCAGCAAACGCATTAAGCACTCCGCCTGGGGAGTACGACC
    (...) 
    ```
- Em vez de imprimir o identificador e toda a sequência, complemente o comando criado na alínea anterior para obter apenas os identificadores:
```bash
>E.faecalis.1
>E.faecalis.2
>L.gasseri.1
>L.monocytogenes.1
>S.aureus.1
>S.aureus.5
>S.epidermidis.1
>S.epidermidis.2
>S.epidermidis.5
>S.agalactiae.1
>S.mutans.1
>S.pneumoniae.1
```

- Partindo novamente do ficheiro `HMP_MOCK.v35.fasta`, imprima as sequências correspondentes apenas aos identificadores `vulgatus` ou `epidermidis` (consulte o comando `egrep`).
??? question "*Resultado Esperado*"
    ```bash
    >B.vulgatus.1
    TGAGGAATATTGGTCAATGGGCGCAGGCCTGAACCAGCCAAGTAGCGTGAAGGATGACTGCCCTATGGGTTGTAAACTTCTTTTATAAAGGAATAAAGTCGGGTATGGATACCCGTTTGCATGTACTTTATGAATAAGGATCGGCTAACTCCGTGCCAGCAGCCGCGGTAATACGGAGGATCCGAGCGTTATCCGGATTTATTGGGTTTAAAGGGAGCGTAGATGGATGTTTAAGTCAGTTGTGAAAGTTTGCGGCTCAACCGTAAAATTGCAGTTGATACTGGATATCTTGAGTGCAGTTGAGGCAGGCGGAATTCGTGGTGTAGCGGTGAAATGCTTAGATATCACGAAGAACTCCGATTGCGAAGGCAGCCTGCTAAGCTGCAACTGACATTGAGGCTCGAAAGTGTGGGTATCAAACAGGATTAGATACCCTGGTAGTCCACACGGTAAACGATGAATACTCGCTGTTTGCGATATACGGCAAGCGGCCAAGCGAAAGCGTTAAGTATTCCACCTGGGGAGTACGCCG
    (...)
    >S.epidermidis.1
    TAGGGAATCTTCCGCAATGGGCGAAAGCCTGACGGAGCAACGCCGCGTGAGTGATGAAGGTCTTCGGATCGTAAAACTCTGTTATTAGGGAAGAACAAATGTGTAAGTAACTATGCACGTCTTGACGGTACCTAATCAGAAAGCCACGGCTAACTACGTGCCAGCAGCCGCGGTAATACGTAGGTGGCAAGCGTTATCCGGAATTATTGGGCGTAAAGCGCGCGTAGGCGGTTTTTTAAGTCTGATGTGAAAGCCCACGGCTCAACCGTGGAGGGTCATTGGAAACTGGAAAACTTGAGTGCAGAAGAGGAAAGTGGAATTCCATGTGTAGCGGTGAAATGCGCAGAGATATGGAGGAACACCAGTGGCGAAGGCGACTTTCTGGTCTGTAACTGACGCTGATGTGCGAAAGCGTGGGGATCAAACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGAGTGCTAAGTGTTAGGGGGTTTCCGCCCCTTAGTGCTGCAGCTAACGCATTAAGCACTCCGCCTGGGGAGTACGACC
    (...)
    ```